Amplicon Architecture Prediction contains:

predict_azfc_architectures: Generates all AZFc architectures that are generated by 1, 2, or 3 NAHR events between identical amplicon units and matches detected copy number states to those architectures.

This script can do two things. First, running it with the -p flag will generate figures of the reference AZFc architecture and all predicted 1-, 2-, and 3-NAHR event architectures.

Second, inputting a pickled pandas dataframe of men with haplogroups and amplicon copy numbers (using the -d flag) will create a file describing the types of AZFc variants present in the dataframe and generate a figure of the 1-, 2-, and 3-NAHR event architectures present in those men.

The output file first summarizes the total number of men with each category of AZFc structure (reference, 1-step, 2-step, 3-step, and complex/non-NAHR). It then gives a list of the copy number states that match predicted 1-, 2-, or 3-NAHR event architectures, including the name of each variant (if a name exists), the number of men in the dataframe with that variant, and the minimum number of NAHR rearrangement events necessary to reach that copy number state. If a structure can also be formed by a single non-NAHR mediated deletion or duplication events, that is noted. (It also includes a category "other," the men that do not match a 1-, 2-, or 3-step architecture.)

The output file then details each unpredicted state. It lists the copy number of each amplicon, the number of men with that copy number state, the haplogroups of those men, and the IDs of those men. It then states by how many amplicon copies that state differs from a single non-NAHR mediated deletion or duplication events. For example, "3 off of non-NAHR" means that the state differs from a non-NAHR deletion/duplication by three copies of one amplicon, one copy of three different amplicons, or two copies of one amplicon and one copy of another. "0 off of non-NAHR" means that exact state could arise from a non-NAHR deletion/duplication events.

Then, the file lists the two closest predicted NAHR-mediated structures to the unpredicted state. It also gives the amplicons that differ between the unpredicted state and the closest predicted structure.

Finally, the output file writes how many of the unpredicted amplicon states could be formed by a non-NAHR event (e.g. how many states are "0 off of non-NAHR"), and how many are a single amplicon copy away from a predicted NAHR-mediated structure. (These categories can have some overlap.)


optional arguments:
  -h, --help            show this help message and exit
  -d DATAFRAME, --dataframe DATAFRAME
                        pickle file of pandas dataframe containing amplicon
                        copy number calls
  -o OUTPUT_DIRECTORY, --output_directory OUTPUT_DIRECTORY
                        directory to write output files to (default: current
                        directory)
  -p, --plot_all        create figure of all 866 predicted 1-, 2-, and 3-step
                        architectures
                        


1000_Genomes_amplicons_calls.pickle: pickled pandas dataframe of 1000 Genomes Project copy number calls. This is the same data as Table S4 in Teitz et al. 2018, in the format needed to input into predict_azfc_architectures.py.